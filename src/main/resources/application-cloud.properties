# ==================== CLOUD PROFILE ====================
# Doppler injects all secrets as env vars — NO Vault dependency
# Activate with: SPRING_PROFILES_ACTIVE=cloud

# === Vault: DISABLED for cloud ===
spring.config.import=
spring.cloud.vault.enabled=false

# === Database: local PostgreSQL container ===
spring.r2dbc.url=${DATABASE_URL:r2dbc:postgresql://postgres:5432/blog}
spring.r2dbc.username=${DATABASE_USERNAME:blogadmin}
spring.r2dbc.password=${DATABASE_PASSWORD}

# === Swagger/OpenAPI: OFF ===
springdoc.swagger-ui.enabled=false
springdoc.api-docs.enabled=false

# === Logging ===
logging.level.root=WARN
logging.level.dev.catananti=INFO
logging.level.dev.catananti.controller=DEBUG
logging.level.dev.catananti.service=DEBUG
logging.level.dev.catananti.config.SecurityConfig=INFO

# === Cookie security: HTTPS only ===
jwt.cookie.secure=true
jwt.cookie.domain=${JWT_COOKIE_DOMAIN:catananti.dev}

# === HSTS ===
security.hsts.enabled=true

# === CORS: explicit cloud override (no localhost fallback) ===
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://catananti.dev,https://www.catananti.dev}

# === App URLs: cloud overrides ===
app.url=${APP_URL:https://catananti.dev}
app.site-url=${APP_SITE_URL:https://catananti.dev}

# === Email: cloud overrides (Resend SMTP — Doppler injects actual values) ===
spring.mail.host=${MAIL_HOST:smtp.resend.com}
spring.mail.port=${MAIL_PORT:465}
app.email.from=${MAIL_FROM:noreply@catananti.dev}
app.email.from-name=${MAIL_FROM_NAME:Catananti Portfolio}
app.email.support=${EMAIL_SUPPORT:admin@catananti.dev}
app.contact.notification-email=${CONTACT_NOTIFICATION_EMAIL:admin@catananti.dev}

# === Datadog APM & Metrics (disabled — no API key on this droplet) ===
management.datadog.metrics.export.enabled=${DD_METRICS_ENABLED:false}
management.datadog.metrics.export.api-key=${DD_API_KEY:}
management.datadog.metrics.export.uri=${DD_METRICS_URI:https://api.us5.datadoghq.com}
management.datadog.metrics.export.step=30s

# === Sentry Error Tracking ===
# Sentry 8.x is incompatible with Spring Boot 4.x — exclude auto-configuration
spring.autoconfigure.exclude=io.sentry.spring.boot.jakarta.SentryAutoConfiguration
sentry.dsn=${SENTRY_DSN:}
sentry.environment=production

# === Cloudflare Email Routing ===
cloudflare.api-token=${CF_API_TOKEN:}
cloudflare.zone-id=${CF_ZONE_ID:}
cloudflare.email-routing.domain=${CF_EMAIL_DOMAIN:catananti.dev}
cloudflare.email-routing.enabled=${CF_EMAIL_ROUTING_ENABLED:true}
